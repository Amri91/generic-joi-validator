## Usage
```
const { JoiValidator } = require('generic-joi-validator');
const joiValidator = new JoiValidator();

// Use a translator to extract Joi schema from your database
const mongoose = require('mongoose');
const { Schema } = mongoose;
const getJoiSchema = require('mongoose-to-joi-translator');
joiValidator.schemata.stores = getJoiSchema(new Schema({
    name: {
        type: String,
        required: true
    },
    location: new Schema({
        latitude: {
            type: String,
            required: true
        },
        longitude: {
            type: String,
            required: true
        }
    })
}));


// or add your schema manually
joiValidator.schemata.stores = {
    name: Joi.string().required(),
    location: {
        latitude: Joi.string().required(),
        longitude: Joi.string().required()
    }
};

// With koa
const Koa = require('koa');
const bodyParser = require('koa-bodyparser');
const Router = require('koa-router');

const router = new Router();
const app = new Koa();

app.use(bodyParser());

const koaValidator = async (ctx, next) => {
    const { error, value } = joiValidator.prepare(ctx.url.substr(ctx.url.lastIndexOf('/') + 1), ctx.request.body);
    ctx.assert(!error, 400, value);
    ctx.state.data = value;
    return next();
};

router.post(
    '/stores',
    koaValidator,
    async (ctx, next) => {
        ctx.body = ctx.state.data;
        return next();
    }
);

app.use(router.allowedMethods({ throw: true }));
app.use(router.routes());

app.listen(3000);
```

## Install
```
npm install generic-joi-validator
```

## Test
```
npm test
```

{{>main}}